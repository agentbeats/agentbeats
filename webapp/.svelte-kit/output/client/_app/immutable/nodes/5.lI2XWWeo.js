import"../chunks/CWj6FrbW.js";import{o as lt,a as nt}from"../chunks/B-G1-8zH.js";import{p as dt,g as I,aB as vt,f as l,h as ut,k as S,a as t,b as ct,$ as _t,d as z,t as P,s as r,l as ue,c as o,i as e,u as Le,e as pt,q as U,j as p,n as w,r as a,aC as ft}from"../chunks/D_E79TID.js";import{i as C,s as mt,a as gt}from"../chunks/D0mllNP8.js";import{e as je,i as ze}from"../chunks/CqRAOBwW.js";import{r as Ve,s as $t}from"../chunks/eloSdJH1.js";import{c as Je}from"../chunks/vcUTqvk3.js";import{r as xt}from"../chunks/gMceMjmh.js";import{g as be}from"../chunks/BXNnu7_f.js";import{f as ht,a as yt,r as bt}from"../chunks/BbsVzjoZ.js";import{C as ce,a as Be,b as De,c as _e}from"../chunks/B6GxE72l.js";import{C as Ne}from"../chunks/CDE7rHBv.js";import{B as Pe}from"../chunks/RLpfKpGz.js";import{L as ae}from"../chunks/2xnkTWfy.js";import{I as se}from"../chunks/D5HnK-cA.js";import"../chunks/tc0rB4gA.js";import{s as Pt,u as At,l as wt}from"../chunks/CRPrjd5f.js";const Ct=async({fetch:Ae})=>{try{console.log("[register-agent/+page.ts] Loading agents for reference...");const J=await Ae("/api/agents");if(!J.ok){const we=await J.json();throw new Error(we.detail||"Failed to fetch agents")}const pe=await J.json();return console.log("[register-agent/+page.ts] Loaded agents:",pe),{agents:pe}}catch(J){return console.error("[register-agent/+page.ts] Error loading agents:",J),{agents:[]}}},hr=Object.freeze(Object.defineProperty({__proto__:null,load:Ct},Symbol.toStringTag,{value:"Module"}));var qt=l('<div class="text-green-600">Agent registered successfully! Redirecting to agents page...</div>'),Rt=l('<div class="text-destructive"> </div>'),kt=l("<!> <!>",1),Et=l('<div class="flex flex-col items-center justify-center py-8 space-y-4"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div> <div class="text-muted-foreground">Loading agent card...</div></div>'),Lt=l('<div class="flex flex-col items-center justify-center py-8 space-y-4"><div class="text-6xl">ðŸ¤–</div> <div class="text-destructive text-center"><div class="font-medium">Agent Card Error</div> <div class="text-sm mt-1"> </div></div></div>'),jt=l('<p class="text-muted-foreground text-sm"> </p>'),zt=l('<div class="text-sm text-muted-foreground"><span class="font-medium">Version:</span> </div>'),Bt=l('<div class="text-sm text-muted-foreground"><span class="font-medium">Protocol:</span> </div>'),Dt=l('<span class="px-2 py-1 bg-secondary text-secondary-foreground rounded-md text-xs"> </span>'),Nt=l('<div><h4 class="font-medium text-sm mb-2">Capabilities:</h4> <div class="flex flex-wrap gap-1"></div></div>'),St=l('<span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-md text-xs"> </span>'),Ut=l('<div><h4 class="font-medium text-sm mb-2">Skills:</h4> <div class="flex flex-wrap gap-1"></div></div>'),Ft=l('<div class="space-y-4"><div class="flex items-center space-x-3"><div class="text-4xl">ðŸ¤–</div> <div><h3 class="font-semibold text-lg"> </h3> <!></div></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><!> <!></div> <!> <!></div>'),It=l('<div class="flex flex-col items-center justify-center py-8 space-y-4"><div class="text-6xl">ðŸ¤–</div> <div class="text-muted-foreground text-center"><div class="font-medium">Agent Card</div> <div class="text-sm">Enter an agent URL to load the card</div></div></div>'),Ot=l("<!> <!>",1),Tt=l("<!> <!>",1),Mt=l('<div class="text-sm text-muted-foreground">Loading agent card...</div>'),Vt=l('<form class="space-y-4"><div class="space-y-2"><!> <!> <!></div> <div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!> <div class="text-xs text-muted-foreground"> </div></div> <div class="flex gap-2 pt-4"><!> <!></div></form>'),Jt=l("<!> <!>",1),Gt=l("<!> <!>",1),Wt=l('<div class="flex items-center justify-center py-8"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div> <span class="ml-2 text-muted-foreground">Analyzing agent card...</span></div>'),Yt=l('<div class="flex gap-2 items-center"><!> <!> <div class="flex items-center gap-1"><input type="checkbox"/> <!></div> <!></div>'),Ht=l('<div class="space-y-4"></div>'),Kt=l('<p class="text-muted-foreground text-sm">No participant requirements defined</p>'),Qt=l('<div class="border-t pt-4"><h4 class="font-medium mb-2">Participant Requirements</h4> <!> <!></div> <div class="border-t pt-4"><h4 class="font-medium mb-2">Battle Configuration</h4> <div class="space-y-2"><!> <!> <div class="text-xs text-muted-foreground">Maximum time allowed for the battle to complete</div></div></div>',1),Xt=l('<p class="text-muted-foreground text-sm">This will be a regular participant agent</p>'),Zt=l('<div class="text-destructive text-sm"> </div>'),er=l('<div class="flex items-center gap-2"><input type="checkbox" id="is_green"/> <!></div> <!> <!>',1),tr=l("<!> <!>",1),rr=l('<div class="container mx-auto p-6 max-w-6xl"><div class="text-center mb-8"><h1 class="text-4xl font-bold mb-6">Register New Agent</h1> <p class="text-muted-foreground">Register a new agent to participate in battles</p></div> <!> <!> <!> <div class="grid gap-6 md:grid-cols-2"><!> <!></div> <details class="mt-8"><summary class="text-lg font-medium cursor-pointer">Debug: Form Data</summary> <div class="mt-4 p-4 bg-muted rounded-lg"><pre class="text-xs overflow-auto max-h-60"> </pre></div></details></div>');function yr(Ae,J){dt(J,!0);const[pe,we]=mt(),Ge=()=>gt(wt,"$loading",pe),We=xt(J,["$$slots","$$events","$$legacy"]);let Ce=null;lt(async()=>{const{data:{session:s}}=await Pt.auth.getSession();if(!s){console.log("Register agent page: No session found, redirecting to login"),be("/login");return}Ce=At.subscribe(y=>{!y&&!Ge()&&(console.log("Register agent page: User logged out, redirecting to login"),be("/login"))})}),nt(()=>{Ce&&Ce()});let n=I(vt({alias:"",agent_url:"",launcher_url:"",is_green:!1,participant_requirements:[],battle_timeout:300,roles:{}})),fe=I(!1),me=I(null),qe=I(!1),ge=I(!1),oe=I(null),d=I(null),$e=I(!0),xe=I(!1),he=I(null),Ye=I(null);function He(){e(n).participant_requirements=[...e(n).participant_requirements,{role:"",name:"",required:!1}]}function Ke(s){e(n).participant_requirements=e(n).participant_requirements.filter((y,E)=>E!==s)}async function Qe(){var s;if(!e(n).agent_url.trim()){p(d,null),p(oe,null),p($e,!0);return}try{p(ge,!0),p(oe,null),p(d,await ht(e(n).agent_url),!0),p($e,!0),!e(n).alias.trim()&&((s=e(d))!=null&&s.name)&&(e(n).alias=e(d).name),await Xe()}catch(y){p(oe,y instanceof Error?y.message:"Failed to load agent card",!0),p(d,null),p($e,!1)}finally{p(ge,!1)}}async function Xe(){if(e(d))try{p(xe,!0),p(he,null);const s=await yt(e(d));s.is_green&&(e(n).is_green=!0,e(n).participant_requirements=s.participant_requirements||[],e(n).battle_timeout=s.battle_timeout||300)}catch(s){p(he,s instanceof Error?s.message:"Failed to analyze agent card",!0),console.error("Agent card analysis failed:",s)}finally{p(xe,!1)}}function Ze(){Qe()}async function et(){var s;try{p(fe,!0),p(me,null),p(qe,!1);const y={...e(n),name:e(n).alias.trim()||((s=e(d))==null?void 0:s.name)||e(n).alias},E=await bt(y);p(qe,!0),p(n,{name:"",agent_url:"",launcher_url:"",is_green:!1,participant_requirements:[]},!0),setTimeout(()=>be("/agents"),2e3)}catch(y){p(me,y instanceof Error?y.message:"Failed to register agent",!0)}finally{p(fe,!1)}}var Re=rr();ut(s=>{_t.title="Register Agent - AgentBeats"});var Se=r(o(Re),2);{var tt=s=>{ce(s,{class:"mb-6",children:(y,E)=>{_e(y,{children:(B,K)=>{var b=qt();t(B,b)},$$slots:{default:!0}})},$$slots:{default:!0}})};C(Se,s=>{e(qe)&&s(tt)})}var Ue=r(Se,2);{var rt=s=>{ce(s,{class:"mb-6",children:(y,E)=>{_e(y,{children:(B,K)=>{var b=Rt(),Q=o(b,!0);a(b),S(()=>U(Q,e(me))),t(B,b)},$$slots:{default:!0}})},$$slots:{default:!0}})};C(Ue,s=>{e(me)&&s(rt)})}var Fe=r(Ue,2);ce(Fe,{class:"mb-6",children:(s,y)=>{var E=Ot(),B=z(E);Be(B,{children:(b,Q)=>{var g=kt(),A=z(g);De(A,{children:($,f)=>{w();var v=P("Agent Card");t($,v)},$$slots:{default:!0}});var D=r(A,2);Ne(D,{children:($,f)=>{w();var v=P("Preview of the agent information");t($,v)},$$slots:{default:!0}}),t(b,g)},$$slots:{default:!0}});var K=r(B,2);_e(K,{children:(b,Q)=>{var g=ue(),A=z(g);{var D=f=>{var v=Et();t(f,v)},$=f=>{var v=ue(),F=z(v);{var O=m=>{var q=Lt(),T=r(o(q),2),M=r(o(T),2),Z=o(M,!0);a(M),a(T),a(q),S(()=>U(Z,e(oe))),t(m,q)},X=m=>{var q=ue(),T=z(q);{var M=u=>{var x=Ft(),L=o(x),i=r(o(L),2),h=o(i),N=o(h,!0);a(h);var te=r(h,2);{var ye=c=>{var _=jt(),R=o(_,!0);a(_),S(()=>U(R,e(d).description)),t(c,_)};C(te,c=>{e(d).description&&c(ye)})}a(i),a(L);var re=r(L,2),ie=o(re);{var Ee=c=>{var _=zt(),R=r(o(_));a(_),S(()=>U(R,` ${e(d).version??""}`)),t(c,_)};C(ie,c=>{e(d).version&&c(Ee)})}var k=r(ie,2);{var V=c=>{var _=Bt(),R=r(o(_));a(_),S(()=>U(R,` ${e(d).protocolVersion??""}`)),t(c,_)};C(k,c=>{e(d).protocolVersion&&c(V)})}a(re);var G=r(re,2);{var W=c=>{var _=Nt(),R=r(o(_),2);je(R,21,()=>Object.entries(e(d).capabilities),ze,(Y,de)=>{var H=Le(()=>ft(e(de),2));let j=()=>e(H)[0],ve=()=>e(H)[1];var ee=Dt(),it=o(ee);a(ee),S(()=>U(it,`${j()??""}: ${(typeof ve()=="boolean"?ve()?"Yes":"No":ve())??""}`)),t(Y,ee)}),a(R),a(_),t(c,_)};C(G,c=>{e(d).capabilities&&typeof e(d).capabilities=="object"&&c(W)})}var le=r(G,2);{var ne=c=>{var _=Ut(),R=r(o(_),2);je(R,21,()=>e(d).skills,ze,(Y,de)=>{var H=St(),j=o(H,!0);a(H),S(()=>U(j,e(de).name)),t(Y,H)}),a(R),a(_),t(c,_)};C(le,c=>{e(d).skills&&e(d).skills.length>0&&c(ne)})}a(x),S(()=>U(N,e(d).name||"Unnamed Agent")),t(u,x)},Z=u=>{var x=It();t(u,x)};C(T,u=>{e(d)?u(M):u(Z,!1)},!0)}t(m,q)};C(F,m=>{e(oe)?m(O):m(X,!1)},!0)}t(f,v)};C(A,f=>{e(ge)?f(D):f($,!1)})}t(b,g)},$$slots:{default:!0}}),t(s,E)},$$slots:{default:!0}});var ke=r(Fe,2),Ie=o(ke);ce(Ie,{children:(s,y)=>{var E=Jt(),B=z(E);Be(B,{children:(b,Q)=>{var g=Tt(),A=z(g);De(A,{children:($,f)=>{w();var v=P("Agent Information");t($,v)},$$slots:{default:!0}});var D=r(A,2);Ne(D,{children:($,f)=>{w();var v=P("Enter the details for your new agent");t($,v)},$$slots:{default:!0}}),t(b,g)},$$slots:{default:!0}});var K=r(B,2);_e(K,{children:(b,Q)=>{var g=Vt(),A=o(g),D=o(A);ae(D,{for:"agent_url",children:(i,h)=>{w();var N=P("Agent URL");t(i,N)},$$slots:{default:!0}});var $=r(D,2);se($,{id:"agent_url",type:"text",placeholder:"http://localhost:6001",onblur:Ze,required:!0,get value(){return e(n).agent_url},set value(i){e(n).agent_url=i}});var f=r($,2);{var v=i=>{var h=Mt();t(i,h)};C(f,i=>{e(ge)&&i(v)})}a(A);var F=r(A,2),O=o(F);ae(O,{for:"launcher_url",children:(i,h)=>{w();var N=P("Launcher URL");t(i,N)},$$slots:{default:!0}});var X=r(O,2);se(X,{id:"launcher_url",type:"text",placeholder:"http://localhost:6001/launcher",required:!0,get value(){return e(n).launcher_url},set value(i){e(n).launcher_url=i}}),a(F);var m=r(F,2),q=o(m);ae(q,{for:"name",children:(i,h)=>{w();var N=P("Agent Alias (Optional)");t(i,N)},$$slots:{default:!0}});var T=r(q,2);{let i=Le(()=>{var h;return((h=e(d))==null?void 0:h.name)||"Will use agent card name if not provided"});se(T,{id:"name",type:"text",get placeholder(){return e(i)},get value(){return e(n).alias},set value(h){e(n).alias=h}})}var M=r(T,2),Z=o(M);a(M),a(m);var u=r(m,2),x=o(u);{let i=Le(()=>e(fe)||!e($e)||!!e(Ye));Pe(x,{type:"submit",get disabled(){return e(i)},children:(h,N)=>{w();var te=P();S(()=>U(te,e(fe)?"Registering...":"Register Agent")),t(h,te)},$$slots:{default:!0}})}var L=r(x,2);Pe(L,{variant:"outline",type:"button",onclick:()=>be("/agents"),children:(i,h)=>{w();var N=P("Cancel");t(i,N)},$$slots:{default:!0}}),a(u),a(g),S(()=>{var i;return U(Z,`Leave empty to use the name from agent card: ${((i=e(d))==null?void 0:i.name)||"Not loaded yet"}`)}),pt("submit",g,i=>{i.preventDefault(),et()}),t(b,g)},$$slots:{default:!0}}),t(s,E)},$$slots:{default:!0}});var at=r(Ie,2);ce(at,{children:(s,y)=>{var E=tr(),B=z(E);Be(B,{children:(b,Q)=>{var g=Gt(),A=z(g);De(A,{children:($,f)=>{w();var v=P("Agent Type & Requirements");t($,v)},$$slots:{default:!0}});var D=r(A,2);Ne(D,{children:($,f)=>{var v=ue(),F=z(v);{var O=m=>{var q=P("Analyzing agent card and suggesting configuration...");t(m,q)},X=m=>{var q=P("Configure agent type and participant requirements");t(m,q)};C(F,m=>{e(xe)?m(O):m(X,!1)})}t($,v)},$$slots:{default:!0}}),t(b,g)},$$slots:{default:!0}});var K=r(B,2);_e(K,{class:"space-y-6",children:(b,Q)=>{var g=ue(),A=z(g);{var D=f=>{var v=Wt();t(f,v)},$=f=>{var v=er(),F=z(v),O=o(F);Ve(O);var X=r(O,2);ae(X,{for:"is_green",children:(u,x)=>{w();var L=P("Green Agent (Battle Initiator)");t(u,L)},$$slots:{default:!0}}),a(F);var m=r(F,2);{var q=u=>{var x=Qt(),L=z(x),i=r(o(L),2);Pe(i,{variant:"outline",onclick:He,class:"mb-4",children:(k,V)=>{w();var G=P("Add Requirement");t(k,G)},$$slots:{default:!0}});var h=r(i,2);{var N=k=>{var V=Ht();je(V,21,()=>e(n).participant_requirements,ze,(G,W,le)=>{var ne=Yt(),c=o(ne);se(c,{placeholder:"Role",class:"w-1/3",get value(){return e(W).role},set value(j){e(W).role=j}});var _=r(c,2);se(_,{placeholder:"Name",class:"w-1/3",get value(){return e(W).name},set value(j){e(W).name=j}});var R=r(_,2),Y=o(R);Ve(Y),$t(Y,"id",`required-${le}`);var de=r(Y,2);ae(de,{for:`required-${le}`,children:(j,ve)=>{w();var ee=P("Required");t(j,ee)},$$slots:{default:!0}}),a(R);var H=r(R,2);Pe(H,{variant:"outline",size:"sm",onclick:()=>Ke(le),children:(j,ve)=>{w();var ee=P("Remove");t(j,ee)},$$slots:{default:!0}}),a(ne),Je(Y,()=>e(W).required,j=>e(W).required=j),t(G,ne)}),a(V),t(k,V)},te=k=>{var V=Kt();t(k,V)};C(h,k=>{e(n).participant_requirements.length>0?k(N):k(te,!1)})}a(L);var ye=r(L,2),re=r(o(ye),2),ie=o(re);ae(ie,{for:"battle_timeout",children:(k,V)=>{w();var G=P("Battle Timeout (seconds)");t(k,G)},$$slots:{default:!0}});var Ee=r(ie,2);se(Ee,{id:"battle_timeout",type:"number",placeholder:"300",min:"1",class:"w-full",get value(){return e(n).battle_timeout},set value(k){e(n).battle_timeout=k}}),w(2),a(re),a(ye),t(u,x)},T=u=>{var x=Xt();t(u,x)};C(m,u=>{e(n).is_green?u(q):u(T,!1)})}var M=r(m,2);{var Z=u=>{var x=Zt(),L=o(x);a(x),S(()=>U(L,`AI Analysis Error: ${e(he)??""}`)),t(u,x)};C(M,u=>{e(he)&&u(Z)})}Je(O,()=>e(n).is_green,u=>e(n).is_green=u),t(f,v)};C(A,f=>{e(xe)?f(D):f($,!1)})}t(b,g)},$$slots:{default:!0}}),t(s,E)},$$slots:{default:!0}}),a(ke);var Oe=r(ke,2),Te=r(o(Oe),2),Me=o(Te),st=o(Me,!0);a(Me),a(Te),a(Oe),a(Re),S(s=>U(st,s),[()=>JSON.stringify(e(n),null,2)]),t(Ae,Re);var ot=ct({data:We});return we(),ot}export{yr as component,hr as universal};

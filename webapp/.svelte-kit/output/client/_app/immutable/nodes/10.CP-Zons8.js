var $r=Object.defineProperty;var br=n=>{throw TypeError(n)};var to=(n,t,e)=>t in n?$r(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var p=(n,t,e)=>to(n,typeof t!="symbol"?t+"":t,e),Ye=(n,t,e)=>t.has(n)||br("Cannot "+e);var s=(n,t,e)=>(Ye(n,t,"read from private field"),e?e.call(n):t.get(n)),x=(n,t,e)=>t.has(n)?br("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),Xt=(n,t,e,o)=>(Ye(n,t,"write to private field"),o?o.call(n,e):t.set(n,e),e),Ft=(n,t,e)=>(Ye(n,t,"access private method"),e);import"../chunks/CWj6FrbW.js";import{i as eo}from"../chunks/_pPX3X5k.js";import{o as ro,a as oo}from"../chunks/B-G1-8zH.js";import{p as q,l as I,d as b,i as r,u as N,a as i,b as G,f as k,j as g,y as nr,g as ot,aR as so,o as ar,a$ as Lt,ay as L,c as E,az as mt,r as B,s as D,t as ft,k as xt,q as dt,v as Ve,w as io,h as no,m as At,aU as Zt,$ as ao,x as et,bo as Ut,e as yr,n as St,bp as lo}from"../chunks/D_E79TID.js";import{i as K,s as ho,a as uo}from"../chunks/D0mllNP8.js";import{e as Fe}from"../chunks/CqRAOBwW.js";import{r as wr,a as vt,c as zt,s as co}from"../chunks/eloSdJH1.js";import{a as Mr}from"../chunks/vcUTqvk3.js";import{p as m,r as nt,s as Nt}from"../chunks/gMceMjmh.js";import{g as Re}from"../chunks/BXNnu7_f.js";import{C as Sr,a as xr,b as Nr,c as Cr}from"../chunks/B6GxE72l.js";import{C as Pr}from"../chunks/CDE7rHBv.js";import{B as Tr}from"../chunks/RLpfKpGz.js";import{L as Ar}from"../chunks/2xnkTWfy.js";import{b as go,d as Vr,D as lr,O as po,e as fo,o as Rr,f as vo,h as mo,P as _o,j as bo,k as yo,l as wo,F as So,m as xo,n as No}from"../chunks/1q5JTXAK.js";import{C as Fr,A as jt,c as $t,e as Ir,d as Qe,T as Or,P as Ur,H as jr,f as Kr,E as zr,n as Ot,I as Co}from"../chunks/DAY4XnSZ.js";import{m as kt,s as Po,w as Ct,a as Be,i as Lr,n as Jr,o as To,h as A,d as Ao,b as Io,p as Oo,j as ko,f as Jt}from"../chunks/_F7RrdPt.js";import{o as Wr}from"../chunks/DnZHUnwV.js";import{g as Ho,D as Do,n as Bo,p as Eo,f as Mo,b as Vo,C as Ro,a as qr}from"../chunks/D8iKKmfn.js";import"../chunks/tc0rB4gA.js";import{s as Fo,u as Uo,l as jo}from"../chunks/CRPrjd5f.js";import{c as Bt}from"../chunks/CCVs6nBf.js";function Ko(n){return function(...t){var e=t[0];return e.preventDefault(),n==null?void 0:n.apply(this,t)}}var zo=k("<input/>"),Lo=k("<input/>");function Jo(n,t){q(t,!0);let e=m(t,"value",15),o=nt(t,["$$slots","$$events","$$legacy","value"]);const d=N(()=>kt(o,{"aria-hidden":"true",tabindex:-1,style:Po}));var v=I(),a=b(v);{var u=h=>{var c=zo();wr(c),vt(c,()=>({...r(d),value:e()})),i(h,c)},l=h=>{var c=Lo();wr(c),vt(c,()=>({...r(d)})),Mr(c,e),i(h,c)};K(a,h=>{r(d).type==="checkbox"?h(u):h(l,!1)})}i(n,v),G()}var It,Et,Dt;class Wo{constructor(t){x(this,It);x(this,Et,N(()=>s(this,It).candidateValues()));x(this,Dt);Xt(this,It,t),Xt(this,Dt,go("",{afterMs:1e3,getWindow:s(this,It).getWindow})),this.handleTypeaheadSearch=this.handleTypeaheadSearch.bind(this),this.resetTypeahead=this.resetTypeahead.bind(this)}handleTypeaheadSearch(t){if(!s(this,It).enabled()||!r(s(this,Et)).length)return;s(this,Dt).current=s(this,Dt).current+t;const e=s(this,It).getCurrentItem(),o=r(s(this,Et)).find(u=>u===e)??"",d=r(s(this,Et)).map(u=>u??""),v=Ho(d,s(this,Dt).current,o),a=r(s(this,Et)).find(u=>u===v);return a&&s(this,It).onMatch(a),a}resetTypeahead(){s(this,Dt).current=""}}It=new WeakMap,Et=new WeakMap,Dt=new WeakMap;const qo=[$t,Ur,jr],Go=[jt,Kr,zr],Yo=[...qo,...Go],Qo=Ao({component:"select",parts:["trigger","content","item","viewport","scroll-up-button","scroll-down-button","group","group-label","separator","arrow","input","content-wrapper","item-text","value"]}),Ee=new Fr("Select.Root | Combobox.Root"),Ke=new Fr("Select.Content | Combobox.Content");var te,ee,re,oe,se,ie,ne,ae,le,Ue;class Gr{constructor(t){p(this,"opts");x(this,te,ot(!1));x(this,ee,ot(null));x(this,re,ot(null));x(this,oe,ot(null));x(this,se,ot(""));x(this,ie,ot(null));x(this,ne,N(()=>this.highlightedNode?this.highlightedNode.getAttribute("data-value"):null));x(this,ae,N(()=>{if(this.highlightedNode)return this.highlightedNode.id}));x(this,le,N(()=>this.highlightedNode?this.highlightedNode.getAttribute("data-label"):null));p(this,"isUsingKeyboard",!1);p(this,"isCombobox",!1);p(this,"domContext",new lr(()=>null));x(this,Ue,fo(this.setHighlightedToFirstCandidate.bind(this),20));p(this,"getBitsAttr",t=>Qo.getAttr(t,this.isCombobox?"combobox":void 0));this.opts=t,this.isCombobox=t.isCombobox,new po({ref:A.with(()=>this.contentNode),open:this.opts.open,onComplete:()=>{this.opts.onOpenChangeComplete.current(this.opts.open.current)}}),so(()=>{this.opts.open.current||this.setHighlightedNode(null)})}get touchedInput(){return r(s(this,te))}set touchedInput(t){g(s(this,te),t,!0)}get inputNode(){return r(s(this,ee))}set inputNode(t){g(s(this,ee),t,!0)}get contentNode(){return r(s(this,re))}set contentNode(t){g(s(this,re),t,!0)}get triggerNode(){return r(s(this,oe))}set triggerNode(t){g(s(this,oe),t,!0)}get valueId(){return r(s(this,se))}set valueId(t){g(s(this,se),t,!0)}get highlightedNode(){return r(s(this,ie))}set highlightedNode(t){g(s(this,ie),t,!0)}get highlightedValue(){return r(s(this,ne))}set highlightedValue(t){g(s(this,ne),t)}get highlightedId(){return r(s(this,ae))}set highlightedId(t){g(s(this,ae),t)}get highlightedLabel(){return r(s(this,le))}set highlightedLabel(t){g(s(this,le),t)}setHighlightedNode(t,e=!1){this.highlightedNode=t,t&&(this.isUsingKeyboard||e)&&t.scrollIntoView({block:this.opts.scrollAlignment.current})}getCandidateNodes(){const t=this.contentNode;return t?Array.from(t.querySelectorAll(`[${this.getBitsAttr("item")}]:not([data-disabled])`)):[]}setHighlightedToFirstCandidate(t={debounced:!1}){if(t.debounced){s(this,Ue).call(this);return}this.setHighlightedNode(null);const e=this.getCandidateNodes();e.length&&this.setHighlightedNode(e[0])}getNodeByValue(t){return this.getCandidateNodes().find(o=>o.dataset.value===t)??null}setOpen(t){this.opts.open.current=t}toggleOpen(){this.opts.open.current=!this.opts.open.current}handleOpen(){this.setOpen(!0)}handleClose(){this.setHighlightedNode(null),this.setOpen(!1)}toggleMenu(){this.toggleOpen()}}te=new WeakMap,ee=new WeakMap,re=new WeakMap,oe=new WeakMap,se=new WeakMap,ie=new WeakMap,ne=new WeakMap,ae=new WeakMap,le=new WeakMap,Ue=new WeakMap;var de,he,ue,ce;class Xo extends Gr{constructor(e){super(e);p(this,"opts");p(this,"isMulti",!1);x(this,de,N(()=>this.opts.value.current!==""));x(this,he,N(()=>{var o;return this.opts.items.current.length?((o=this.opts.items.current.find(d=>d.value===this.opts.value.current))==null?void 0:o.label)??"":""}));x(this,ue,N(()=>this.opts.items.current.length?this.opts.items.current.filter(o=>!o.disabled).map(o=>o.label):[]));x(this,ce,N(()=>!(this.isMulti||this.opts.items.current.length===0)));this.opts=e,nr(()=>{!this.opts.open.current&&this.highlightedNode&&this.setHighlightedNode(null)}),Ct(()=>this.opts.open.current,()=>{this.opts.open.current&&this.setInitialHighlightedNode()})}get hasValue(){return r(s(this,de))}set hasValue(e){g(s(this,de),e)}get currentLabel(){return r(s(this,he))}set currentLabel(e){g(s(this,he),e)}get candidateLabels(){return r(s(this,ue))}set candidateLabels(e){g(s(this,ue),e)}get dataTypeaheadEnabled(){return r(s(this,ce))}set dataTypeaheadEnabled(e){g(s(this,ce),e)}includesItem(e){return this.opts.value.current===e}toggleItem(e,o=e){this.opts.value.current=this.includesItem(e)?"":e,this.opts.inputValue.current=o}setInitialHighlightedNode(){Vr(()=>{if(this.highlightedNode&&this.domContext.getDocument().contains(this.highlightedNode))return;if(this.opts.value.current!==""){const o=this.getNodeByValue(this.opts.value.current);if(o){this.setHighlightedNode(o,!0);return}}const e=this.getCandidateNodes()[0];e&&this.setHighlightedNode(e,!0)})}}de=new WeakMap,he=new WeakMap,ue=new WeakMap,ce=new WeakMap;var ge;class Zo extends Gr{constructor(e){super(e);p(this,"opts");p(this,"isMulti",!0);x(this,ge,N(()=>this.opts.value.current.length>0));this.opts=e,nr(()=>{!this.opts.open.current&&this.highlightedNode&&this.setHighlightedNode(null)}),Ct(()=>this.opts.open.current,()=>{this.opts.open.current&&this.setInitialHighlightedNode()})}get hasValue(){return r(s(this,ge))}set hasValue(e){g(s(this,ge),e)}includesItem(e){return this.opts.value.current.includes(e)}toggleItem(e,o=e){this.includesItem(e)?this.opts.value.current=this.opts.value.current.filter(d=>d!==e):this.opts.value.current=[...this.opts.value.current,e],this.opts.inputValue.current=o}setInitialHighlightedNode(){Vr(()=>{if(!this.domContext||this.highlightedNode&&this.domContext.getDocument().contains(this.highlightedNode))return;if(this.opts.value.current.length&&this.opts.value.current[0]!==""){const o=this.getNodeByValue(this.opts.value.current[0]);if(o){this.setHighlightedNode(o,!0);return}}const e=this.getCandidateNodes()[0];e&&this.setHighlightedNode(e,!0)})}}ge=new WeakMap;class $o{static create(t){const{type:e,...o}=t,d=e==="single"?new Xo(o):new Zo(o);return Ee.set(d)}}var Mt,Kt,Pt,Yr,Ze,$e,pe;const hr=class hr{constructor(t,e){x(this,Pt);p(this,"opts");p(this,"root");p(this,"attachment");x(this,Mt);x(this,Kt);x(this,pe,N(()=>({id:this.opts.id.current,disabled:this.root.opts.disabled.current?!0:void 0,"aria-haspopup":"listbox","aria-expanded":To(this.root.opts.open.current),"aria-activedescendant":this.root.highlightedId,"data-state":Jr(this.root.opts.open.current),"data-disabled":Lr(this.root.opts.disabled.current),"data-placeholder":this.root.hasValue?void 0:"",[this.root.getBitsAttr("trigger")]:"",onpointerdown:this.onpointerdown,onkeydown:this.onkeydown,onclick:this.onclick,onpointerup:this.onpointerup,...this.attachment})));this.opts=t,this.root=e,this.attachment=Be(t.ref,o=>this.root.triggerNode=o),this.root.domContext=new lr(t.ref),Xt(this,Mt,new Do({getCurrentItem:()=>this.root.highlightedNode,onMatch:o=>{this.root.setHighlightedNode(o)},getActiveElement:()=>this.root.domContext.getActiveElement(),getWindow:()=>this.root.domContext.getWindow()})),Xt(this,Kt,new Wo({getCurrentItem:()=>this.root.isMulti?"":this.root.currentLabel,onMatch:o=>{if(this.root.isMulti||!this.root.opts.items.current)return;const d=this.root.opts.items.current.find(v=>v.label===o);d&&(this.root.opts.value.current=d.value)},enabled:()=>!this.root.isMulti&&this.root.dataTypeaheadEnabled,candidateValues:()=>this.root.isMulti?[]:this.root.candidateLabels,getWindow:()=>this.root.domContext.getWindow()})),this.onkeydown=this.onkeydown.bind(this),this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this),this.onclick=this.onclick.bind(this)}static create(t){return new hr(t,Ee.get())}onkeydown(t){if(this.root.isUsingKeyboard=!0,(t.key===jt||t.key===$t)&&t.preventDefault(),!this.root.opts.open.current){if(t.key===Ir||t.key===Qe||t.key===$t||t.key===jt)t.preventDefault(),this.root.handleOpen();else if(!this.root.isMulti&&this.root.dataTypeaheadEnabled){s(this,Kt).handleTypeaheadSearch(t.key);return}if(this.root.hasValue)return;const a=this.root.getCandidateNodes();if(!a.length)return;if(t.key===$t){const u=a[0];this.root.setHighlightedNode(u)}else if(t.key===jt){const u=a[a.length-1];this.root.setHighlightedNode(u)}return}if(t.key===Or){this.root.handleClose();return}if((t.key===Ir||t.key===Qe&&s(this,Mt).search==="")&&!t.isComposing&&(t.preventDefault(),Ft(this,Pt,$e).call(this)))return;if(t.key===jt&&t.altKey&&this.root.handleClose(),Yo.includes(t.key)){t.preventDefault();const a=this.root.getCandidateNodes(),u=this.root.highlightedNode,l=u?a.indexOf(u):-1,h=this.root.opts.loop.current;let c;if(t.key===$t?c=Bo(a,l,h):t.key===jt?c=Eo(a,l,h):t.key===Kr?c=Mo(a,l,10,h):t.key===Ur?c=Vo(a,l,10,h):t.key===jr?c=a[0]:t.key===zr&&(c=a[a.length-1]),!c)return;this.root.setHighlightedNode(c);return}const e=t.ctrlKey||t.altKey||t.metaKey,o=t.key.length===1,d=t.key===Qe,v=this.root.getCandidateNodes();if(t.key!==Or){if(!e&&(o||d)){!s(this,Mt).handleTypeaheadSearch(t.key,v)&&d&&(t.preventDefault(),Ft(this,Pt,$e).call(this));return}this.root.highlightedNode||this.root.setHighlightedToFirstCandidate()}}onclick(t){t.currentTarget.focus()}onpointerdown(t){if(this.root.opts.disabled.current)return;if(t.pointerType==="touch")return t.preventDefault();const e=t.target;e!=null&&e.hasPointerCapture(t.pointerId)&&(e==null||e.releasePointerCapture(t.pointerId)),t.button===0&&t.ctrlKey===!1&&(this.root.opts.open.current===!1?Ft(this,Pt,Ze).call(this,t):this.root.handleClose())}onpointerup(t){this.root.opts.disabled.current||(t.preventDefault(),t.pointerType==="touch"&&(this.root.opts.open.current===!1?Ft(this,Pt,Ze).call(this,t):this.root.handleClose()))}get props(){return r(s(this,pe))}set props(t){g(s(this,pe),t)}};Mt=new WeakMap,Kt=new WeakMap,Pt=new WeakSet,Yr=function(){this.root.opts.open.current=!0,s(this,Kt).resetTypeahead(),s(this,Mt).resetTypeahead()},Ze=function(t){Ft(this,Pt,Yr).call(this)},$e=function(){const t=this.root.highlightedValue===this.root.opts.value.current;return!this.root.opts.allowDeselect.current&&t&&!this.root.isMulti?(this.root.handleClose(),!0):(this.root.highlightedValue!==null&&this.root.toggleItem(this.root.highlightedValue,this.root.highlightedLabel??void 0),!this.root.isMulti&&!t?(this.root.handleClose(),!0):!1)},pe=new WeakMap;let Xe=hr;var fe,ve,je,me,_e;const ur=class ur{constructor(t,e){p(this,"opts");p(this,"root");p(this,"attachment");x(this,fe,ot(null));x(this,ve,ot(!1));p(this,"domContext");x(this,je,N(()=>vo(this.root.isCombobox?"combobox":"select")));p(this,"onInteractOutside",t=>{if(t.target===this.root.triggerNode||t.target===this.root.inputNode){t.preventDefault();return}this.opts.onInteractOutside.current(t),!t.defaultPrevented&&this.root.handleClose()});p(this,"onEscapeKeydown",t=>{this.opts.onEscapeKeydown.current(t),!t.defaultPrevented&&this.root.handleClose()});p(this,"onOpenAutoFocus",t=>{t.preventDefault()});p(this,"onCloseAutoFocus",t=>{t.preventDefault()});x(this,me,N(()=>({open:this.root.opts.open.current})));x(this,_e,N(()=>({id:this.opts.id.current,role:"listbox","aria-multiselectable":this.root.isMulti?"true":void 0,"data-state":Jr(this.root.opts.open.current),[this.root.getBitsAttr("content")]:"",style:{display:"flex",flexDirection:"column",outline:"none",boxSizing:"border-box",pointerEvents:"auto",...r(s(this,je))},onpointermove:this.onpointermove,...this.attachment})));p(this,"popperProps",{onInteractOutside:this.onInteractOutside,onEscapeKeydown:this.onEscapeKeydown,onOpenAutoFocus:this.onOpenAutoFocus,onCloseAutoFocus:this.onCloseAutoFocus,trapFocus:!1,loop:!1,onPlaced:()=>{this.root.opts.open.current&&(this.isPositioned=!0)}});this.opts=t,this.root=e,this.attachment=Be(t.ref,o=>this.root.contentNode=o),this.domContext=new lr(this.opts.ref),this.root.domContext===null&&(this.root.domContext=this.domContext),Rr(()=>{this.root.contentNode=null,this.isPositioned=!1}),Ct(()=>this.root.opts.open.current,()=>{this.root.opts.open.current||(this.isPositioned=!1)}),this.onpointermove=this.onpointermove.bind(this)}static create(t){return Ke.set(new ur(t,Ee.get()))}get viewportNode(){return r(s(this,fe))}set viewportNode(t){g(s(this,fe),t,!0)}get isPositioned(){return r(s(this,ve))}set isPositioned(t){g(s(this,ve),t,!0)}onpointermove(t){this.root.isUsingKeyboard=!1}get snippetProps(){return r(s(this,me))}set snippetProps(t){g(s(this,me),t)}get props(){return r(s(this,_e))}set props(t){g(s(this,_e),t)}};fe=new WeakMap,ve=new WeakMap,je=new WeakMap,me=new WeakMap,_e=new WeakMap;let tr=ur;var be,ye,we,Se,xe;const cr=class cr{constructor(t,e){p(this,"opts");p(this,"root");p(this,"attachment");x(this,be,N(()=>this.root.includesItem(this.opts.value.current)));x(this,ye,N(()=>this.root.highlightedValue===this.opts.value.current));p(this,"prevHighlighted",new _o(()=>this.isHighlighted));x(this,we,ot(!1));x(this,Se,N(()=>({selected:this.isSelected,highlighted:this.isHighlighted})));x(this,xe,N(()=>({id:this.opts.id.current,role:"option","aria-selected":this.root.includesItem(this.opts.value.current)?"true":void 0,"data-value":this.opts.value.current,"data-disabled":Lr(this.opts.disabled.current),"data-highlighted":this.root.highlightedValue===this.opts.value.current&&!this.opts.disabled.current?"":void 0,"data-selected":this.root.includesItem(this.opts.value.current)?"":void 0,"data-label":this.opts.label.current,[this.root.getBitsAttr("item")]:"",onpointermove:this.onpointermove,onpointerdown:this.onpointerdown,onpointerup:this.onpointerup,...this.attachment})));this.opts=t,this.root=e,this.attachment=Be(t.ref),Wr(()=>{this.root.setHighlightedToFirstCandidate({debounced:!0})}),Rr(()=>{this.root.setHighlightedToFirstCandidate({debounced:!0})}),Ct([()=>this.isHighlighted,()=>this.prevHighlighted.current],()=>{this.isHighlighted?this.opts.onHighlight.current():this.prevHighlighted.current&&this.opts.onUnhighlight.current()}),Ct(()=>this.mounted,()=>{this.mounted&&this.root.setInitialHighlightedNode()}),this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this),this.onpointermove=this.onpointermove.bind(this)}static create(t){return new cr(t,Ee.get())}get isSelected(){return r(s(this,be))}set isSelected(t){g(s(this,be),t)}get isHighlighted(){return r(s(this,ye))}set isHighlighted(t){g(s(this,ye),t)}get mounted(){return r(s(this,we))}set mounted(t){g(s(this,we),t,!0)}handleSelect(){if(this.opts.disabled.current)return;const t=this.opts.value.current===this.root.opts.value.current;if(!this.root.opts.allowDeselect.current&&t&&!this.root.isMulti){this.root.handleClose();return}this.root.toggleItem(this.opts.value.current,this.opts.label.current),!this.root.isMulti&&!t&&this.root.handleClose()}get snippetProps(){return r(s(this,Se))}set snippetProps(t){g(s(this,Se),t)}onpointerdown(t){t.preventDefault()}onpointerup(t){if(!(t.defaultPrevented||!this.opts.ref.current)){if(t.pointerType==="touch"&&!bo){ar(this.opts.ref.current,"click",()=>{this.handleSelect(),this.root.setHighlightedNode(this.opts.ref.current)},{once:!0});return}t.preventDefault(),this.handleSelect(),t.pointerType==="touch"&&this.root.setHighlightedNode(this.opts.ref.current)}}onpointermove(t){t.pointerType!=="touch"&&this.root.highlightedNode!==this.opts.ref.current&&this.root.setHighlightedNode(this.opts.ref.current)}get props(){return r(s(this,xe))}set props(t){g(s(this,xe),t)}};be=new WeakMap,ye=new WeakMap,we=new WeakMap,Se=new WeakMap,xe=new WeakMap;let er=cr;var Ne,Ce;const gr=class gr{constructor(t,e){p(this,"opts");p(this,"root");x(this,Ne,N(()=>this.root.opts.name.current!==""));x(this,Ce,N(()=>({disabled:ko(this.root.opts.disabled.current),required:Oo(this.root.opts.required.current),name:this.root.opts.name.current,value:this.opts.value.current,onfocus:this.onfocus})));this.opts=t,this.root=e,this.onfocus=this.onfocus.bind(this)}static create(t){return new gr(t,Ee.get())}get shouldRender(){return r(s(this,Ne))}set shouldRender(t){g(s(this,Ne),t)}onfocus(t){var e,o;t.preventDefault(),this.root.isCombobox?(o=this.root.inputNode)==null||o.focus():(e=this.root.triggerNode)==null||e.focus()}get props(){return r(s(this,Ce))}set props(t){g(s(this,Ce),t)}};Ne=new WeakMap,Ce=new WeakMap;let rr=gr;var Pe,Te;const pr=class pr{constructor(t,e){p(this,"opts");p(this,"content");p(this,"root");p(this,"attachment");x(this,Pe,ot(0));x(this,Te,N(()=>({id:this.opts.id.current,role:"presentation",[this.root.getBitsAttr("viewport")]:"",style:{position:"relative",flex:1,overflow:"auto"},...this.attachment})));this.opts=t,this.content=e,this.root=e.root,this.attachment=Be(t.ref,o=>this.content.viewportNode=o)}static create(t){return new pr(t,Ke.get())}get prevScrollTop(){return r(s(this,Pe))}set prevScrollTop(t){g(s(this,Pe),t,!0)}get props(){return r(s(this,Te))}set props(t){g(s(this,Te),t)}};Pe=new WeakMap,Te=new WeakMap;let or=pr;var Ae,Ie;class Qr{constructor(t,e){p(this,"opts");p(this,"content");p(this,"root");p(this,"attachment");p(this,"autoScrollTimer",null);p(this,"userScrollTimer",-1);p(this,"isUserScrolling",!1);p(this,"onAutoScroll",Ot);x(this,Ae,ot(!1));x(this,Ie,N(()=>({id:this.opts.id.current,"aria-hidden":Io(!0),style:{flexShrink:0},onpointerdown:this.onpointerdown,onpointermove:this.onpointermove,onpointerleave:this.onpointerleave,...this.attachment})));this.opts=t,this.content=e,this.root=e.root,this.attachment=Be(t.ref),Ct([()=>this.mounted],()=>{if(!this.mounted){this.isUserScrolling=!1;return}this.isUserScrolling}),nr(()=>{this.mounted||this.clearAutoScrollInterval()}),this.onpointerdown=this.onpointerdown.bind(this),this.onpointermove=this.onpointermove.bind(this),this.onpointerleave=this.onpointerleave.bind(this)}get mounted(){return r(s(this,Ae))}set mounted(t){g(s(this,Ae),t,!0)}handleUserScroll(){this.content.domContext.clearTimeout(this.userScrollTimer),this.isUserScrolling=!0,this.userScrollTimer=this.content.domContext.setTimeout(()=>{this.isUserScrolling=!1},200)}clearAutoScrollInterval(){this.autoScrollTimer!==null&&(this.content.domContext.clearTimeout(this.autoScrollTimer),this.autoScrollTimer=null)}onpointerdown(t){if(this.autoScrollTimer!==null)return;const e=o=>{this.onAutoScroll(),this.autoScrollTimer=this.content.domContext.setTimeout(()=>e(o+1),this.opts.delay.current(o))};this.autoScrollTimer=this.content.domContext.setTimeout(()=>e(1),this.opts.delay.current(0))}onpointermove(t){this.onpointerdown(t)}onpointerleave(t){this.clearAutoScrollInterval()}get props(){return r(s(this,Ie))}set props(t){g(s(this,Ie),t)}}Ae=new WeakMap,Ie=new WeakMap;var Oe,ke;const fr=class fr{constructor(t){p(this,"scrollButtonState");p(this,"content");p(this,"root");x(this,Oe,ot(!1));p(this,"scrollIntoViewTimer",null);p(this,"handleScroll",(t=!1)=>{if(t||this.scrollButtonState.handleUserScroll(),!this.content.viewportNode)return;const e=this.content.viewportNode.scrollHeight-this.content.viewportNode.clientHeight,o=Number.parseInt(getComputedStyle(this.content.viewportNode).paddingTop,10);this.canScrollDown=Math.ceil(this.content.viewportNode.scrollTop)<e-o});p(this,"handleAutoScroll",()=>{const t=this.content.viewportNode,e=this.root.highlightedNode;!t||!e||(t.scrollTop=t.scrollTop+e.offsetHeight)});x(this,ke,N(()=>({...this.scrollButtonState.props,[this.root.getBitsAttr("scroll-down-button")]:""})));this.scrollButtonState=t,this.content=t.content,this.root=t.root,this.scrollButtonState.onAutoScroll=this.handleAutoScroll,Ct([()=>this.content.viewportNode,()=>this.content.isPositioned],()=>{if(!(!this.content.viewportNode||!this.content.isPositioned))return this.handleScroll(!0),ar(this.content.viewportNode,"scroll",()=>this.handleScroll())}),Ct(()=>this.scrollButtonState.mounted,()=>{this.scrollButtonState.mounted&&(this.scrollIntoViewTimer&&clearTimeout(this.scrollIntoViewTimer),this.scrollIntoViewTimer=mo(5,()=>{const e=this.root.highlightedNode;e==null||e.scrollIntoView({block:this.root.opts.scrollAlignment.current})}))})}static create(t){return new fr(new Qr(t,Ke.get()))}get canScrollDown(){return r(s(this,Oe))}set canScrollDown(t){g(s(this,Oe),t,!0)}get props(){return r(s(this,ke))}set props(t){g(s(this,ke),t)}};Oe=new WeakMap,ke=new WeakMap;let sr=fr;var He,De;const vr=class vr{constructor(t){p(this,"scrollButtonState");p(this,"content");p(this,"root");x(this,He,ot(!1));p(this,"handleScroll",(t=!1)=>{if(t||this.scrollButtonState.handleUserScroll(),!this.content.viewportNode)return;const e=Number.parseInt(getComputedStyle(this.content.viewportNode).paddingTop,10);this.canScrollUp=this.content.viewportNode.scrollTop-e>.1});p(this,"handleAutoScroll",()=>{!this.content.viewportNode||!this.root.highlightedNode||(this.content.viewportNode.scrollTop=this.content.viewportNode.scrollTop-this.root.highlightedNode.offsetHeight)});x(this,De,N(()=>({...this.scrollButtonState.props,[this.root.getBitsAttr("scroll-up-button")]:""})));this.scrollButtonState=t,this.content=t.content,this.root=t.root,this.scrollButtonState.onAutoScroll=this.handleAutoScroll,Ct([()=>this.content.viewportNode,()=>this.content.isPositioned],()=>{if(!(!this.content.viewportNode||!this.content.isPositioned))return this.handleScroll(!0),ar(this.content.viewportNode,"scroll",()=>this.handleScroll())})}static create(t){return new vr(new Qr(t,Ke.get()))}get canScrollUp(){return r(s(this,He))}set canScrollUp(t){g(s(this,He),t,!0)}get props(){return r(s(this,De))}set props(t){g(s(this,De),t)}};He=new WeakMap,De=new WeakMap;let ir=vr;function kr(n,t){q(t,!0);let e=m(t,"value",15,"");const o=rr.create({value:A.with(()=>e())});var d=I(),v=b(d);{var a=u=>{Jo(u,Nt(()=>o.props,{get autocomplete(){return t.autocomplete},get value(){return e()},set value(l){e(l)}}))};K(v,u=>{o.shouldRender&&u(a)})}i(n,d),G()}var ts=k("<div><div><!></div></div>"),es=k("<div><div><!></div></div>");function rs(n,t){const e=Lt();q(t,!0);let o=m(t,"id",19,()=>Jt(e)),d=m(t,"ref",15,null),v=m(t,"forceMount",3,!1),a=m(t,"side",3,"bottom"),u=m(t,"onInteractOutside",3,Ot),l=m(t,"onEscapeKeydown",3,Ot),h=m(t,"preventScroll",3,!1),c=nt(t,["$$slots","$$events","$$legacy","id","ref","forceMount","side","onInteractOutside","onEscapeKeydown","children","child","preventScroll"]);const P=tr.create({id:A.with(()=>o()),ref:A.with(()=>d(),O=>d(O)),onInteractOutside:A.with(()=>u()),onEscapeKeydown:A.with(()=>l())}),w=N(()=>kt(c,P.props));var T=I(),y=b(T);{var H=O=>{yo(O,Nt(()=>r(w),()=>P.popperProps,{get ref(){return P.opts.ref},get side(){return a()},get enabled(){return P.root.opts.open.current},get id(){return o()},get preventScroll(){return h()},forceMount:!0,popper:(f,C)=>{let J=()=>C==null?void 0:C().props,R=()=>C==null?void 0:C().wrapperProps;var Y=I();const z=N(()=>kt(J(),{style:P.props.style}));var ht=b(Y);{var at=Q=>{var $=I(),_=b($);{let U=N(()=>({props:r(z),wrapperProps:R(),...P.snippetProps}));L(_,()=>t.child,()=>r(U))}i(Q,$)},st=Q=>{var $=ts();vt($,()=>({...R()}));var _=E($);vt(_,()=>({...r(z)}));var U=E(_);L(U,()=>t.children??mt),B(_),B($),i(Q,$)};K(ht,Q=>{t.child?Q(at):Q(st,!1)})}i(f,Y)},$$slots:{popper:!0}}))},F=O=>{var S=I(),f=b(S);{var C=J=>{wo(J,Nt(()=>r(w),()=>P.popperProps,{get ref(){return P.opts.ref},get side(){return a()},get open(){return P.root.opts.open.current},get id(){return o()},get preventScroll(){return h()},forceMount:!1,popper:(Y,z)=>{let ht=()=>z==null?void 0:z().props,at=()=>z==null?void 0:z().wrapperProps;var st=I();const Q=N(()=>kt(ht(),{style:P.props.style}));var $=b(st);{var _=M=>{var V=I(),ut=b(V);{let ct=N(()=>({props:r(Q),wrapperProps:at(),...P.snippetProps}));L(ut,()=>t.child,()=>r(ct))}i(M,V)},U=M=>{var V=es();vt(V,()=>({...at()}));var ut=E(V);vt(ut,()=>({...r(Q)}));var ct=E(ut);L(ct,()=>t.children??mt),B(ut),B(V),i(M,V)};K($,M=>{t.child?M(_):M(U,!1)})}i(Y,st)},$$slots:{popper:!0}}))};K(f,J=>{v()||J(C)},!0)}i(O,S)};K(y,O=>{v()?O(H):O(F,!1)})}i(n,T),G()}function dr(n,t){q(t,!0);let e=m(t,"mounted",15,!1),o=m(t,"onMountedChange",3,Ot);Wr(()=>(e(!0),o()(!0),()=>{e(!1),o()(!1)})),G()}var os=k("<div><!></div>"),ss=k("<!> <!>",1);function is(n,t){const e=Lt();q(t,!0);let o=m(t,"id",19,()=>Jt(e)),d=m(t,"ref",15,null),v=m(t,"label",19,()=>t.value),a=m(t,"disabled",3,!1),u=m(t,"onHighlight",3,Ot),l=m(t,"onUnhighlight",3,Ot),h=nt(t,["$$slots","$$events","$$legacy","id","ref","value","label","disabled","children","child","onHighlight","onUnhighlight"]);const c=er.create({id:A.with(()=>o()),ref:A.with(()=>d(),O=>d(O)),value:A.with(()=>t.value),disabled:A.with(()=>a()),label:A.with(()=>v()),onHighlight:A.with(()=>u()),onUnhighlight:A.with(()=>l())}),P=N(()=>kt(h,c.props));var w=ss(),T=b(w);{var y=O=>{var S=I(),f=b(S);{let C=N(()=>({props:r(P),...c.snippetProps}));L(f,()=>t.child,()=>r(C))}i(O,S)},H=O=>{var S=os();vt(S,()=>({...r(P)}));var f=E(S);L(f,()=>t.children??mt,()=>c.snippetProps),B(S),i(O,S)};K(T,O=>{t.child?O(y):O(H,!1)})}var F=D(T,2);dr(F,{get mounted(){return c.mounted},set mounted(O){c.mounted=O}}),i(n,w),G()}var ns=k("<div><!></div>");function as(n,t){const e=Lt();q(t,!0);let o=m(t,"id",19,()=>Jt(e)),d=m(t,"ref",15,null),v=nt(t,["$$slots","$$events","$$legacy","id","ref","children","child"]);const a=or.create({id:A.with(()=>o()),ref:A.with(()=>d(),w=>d(w))}),u=N(()=>kt(v,a.props));var l=I(),h=b(l);{var c=w=>{var T=I(),y=b(T);L(y,()=>t.child,()=>({props:r(u)})),i(w,T)},P=w=>{var T=ns();vt(T,()=>({...r(u)}));var y=E(T);L(y,()=>t.children??mt),B(T),i(w,T)};K(h,w=>{t.child?w(c):w(P,!1)})}i(n,l),G()}var ls=k("<div><!></div>"),ds=k("<!> <!>",1);function hs(n,t){const e=Lt();q(t,!0);let o=m(t,"id",19,()=>Jt(e)),d=m(t,"ref",15,null),v=m(t,"delay",3,()=>50),a=nt(t,["$$slots","$$events","$$legacy","id","ref","delay","child","children"]);const u=sr.create({id:A.with(()=>o()),ref:A.with(()=>d(),w=>d(w)),delay:A.with(()=>v())}),l=N(()=>kt(a,u.props));var h=I(),c=b(h);{var P=w=>{var T=ds(),y=b(T);dr(y,{get mounted(){return u.scrollButtonState.mounted},set mounted(S){u.scrollButtonState.mounted=S}});var H=D(y,2);{var F=S=>{var f=I(),C=b(f);L(C,()=>t.child,()=>({props:a})),i(S,f)},O=S=>{var f=ls();vt(f,()=>({...r(l)}));var C=E(f);L(C,()=>t.children??mt),B(f),i(S,f)};K(H,S=>{t.child?S(F):S(O,!1)})}i(w,T)};K(c,w=>{u.canScrollDown&&w(P)})}i(n,h),G()}var us=k("<div><!></div>"),cs=k("<!> <!>",1);function gs(n,t){const e=Lt();q(t,!0);let o=m(t,"id",19,()=>Jt(e)),d=m(t,"ref",15,null),v=m(t,"delay",3,()=>50),a=nt(t,["$$slots","$$events","$$legacy","id","ref","delay","child","children"]);const u=ir.create({id:A.with(()=>o()),ref:A.with(()=>d(),w=>d(w)),delay:A.with(()=>v())}),l=N(()=>kt(a,u.props));var h=I(),c=b(h);{var P=w=>{var T=cs(),y=b(T);dr(y,{get mounted(){return u.scrollButtonState.mounted},set mounted(S){u.scrollButtonState.mounted=S}});var H=D(y,2);{var F=S=>{var f=I(),C=b(f);L(C,()=>t.child,()=>({props:a})),i(S,f)},O=S=>{var f=us();vt(f,()=>({...r(l)}));var C=E(f);L(C,()=>t.children??mt),B(f),i(S,f)};K(H,S=>{t.child?S(F):S(O,!1)})}i(w,T)};K(c,w=>{u.canScrollUp&&w(P)})}i(n,h),G()}var ps=k("<!> <!>",1);function fs(n,t){q(t,!0);let e=m(t,"value",15),o=m(t,"onValueChange",3,Ot),d=m(t,"name",3,""),v=m(t,"disabled",3,!1),a=m(t,"open",15,!1),u=m(t,"onOpenChange",3,Ot),l=m(t,"onOpenChangeComplete",3,Ot),h=m(t,"loop",3,!1),c=m(t,"scrollAlignment",3,"nearest"),P=m(t,"required",3,!1),w=m(t,"items",19,()=>[]),T=m(t,"allowDeselect",3,!1);function y(){e()===void 0&&e(t.type==="single"?"":[])}y(),Ct.pre(()=>e(),()=>{y()});let H=ot("");const F=$o.create({type:t.type,value:A.with(()=>e(),R=>{e(R),o()(R)}),disabled:A.with(()=>v()),required:A.with(()=>P()),open:A.with(()=>a(),R=>{a(R),u()(R)}),loop:A.with(()=>h()),scrollAlignment:A.with(()=>c()),name:A.with(()=>d()),isCombobox:!1,items:A.with(()=>w()),allowDeselect:A.with(()=>T()),inputValue:A.with(()=>r(H),R=>g(H,R,!0)),onOpenChangeComplete:A.with(()=>l())});var O=ps(),S=b(O);So(S,{children:(R,Y)=>{var z=I(),ht=b(z);L(ht,()=>t.children??mt),i(R,z)},$$slots:{default:!0}});var f=D(S,2);{var C=R=>{var Y=I(),z=b(Y);{var ht=at=>{var st=I(),Q=b(st);Fe(Q,16,()=>F.opts.value.current,$=>$,($,_)=>{kr($,{get value(){return _},get autocomplete(){return t.autocomplete}})}),i(at,st)};K(z,at=>{F.opts.value.current.length&&at(ht)})}i(R,Y)},J=R=>{kr(R,{get autocomplete(){return t.autocomplete},get value(){return F.opts.value.current},set value(Y){F.opts.value.current=Y}})};K(f,R=>{Array.isArray(F.opts.value.current)?R(C):R(J,!1)})}i(n,O),G()}var vs=k("<button><!></button>");function ms(n,t){const e=Lt();q(t,!0);let o=m(t,"id",19,()=>Jt(e)),d=m(t,"ref",15,null),v=m(t,"type",3,"button"),a=nt(t,["$$slots","$$events","$$legacy","id","ref","child","children","type"]);const u=Xe.create({id:A.with(()=>o()),ref:A.with(()=>d(),P=>d(P))}),l=N(()=>kt(a,u.props,{type:v()}));var h=I(),c=b(h);Bt(c,()=>xo,(P,w)=>{w(P,{get id(){return o()},get ref(){return u.opts.ref},children:(T,y)=>{var H=I(),F=b(H);{var O=f=>{var C=I(),J=b(C);L(J,()=>t.child,()=>({props:r(l)})),i(f,C)},S=f=>{var C=vs();vt(C,()=>({...r(l)}));var J=E(C);L(J,()=>t.children??mt),B(C),i(f,C)};K(F,f=>{t.child?f(O):f(S,!1)})}i(T,H)},$$slots:{default:!0}})}),i(n,h),G()}const _s=async({fetch:n})=>{try{console.log("[stage-battle/+page.ts] Loading agents for battle staging...");const t=await n("/api/agents");if(!t.ok){const v=await t.json();throw new Error(v.detail||"Failed to fetch agents")}const e=await t.json();console.log("[stage-battle/+page.ts] Loaded agents:",e);const o=e.filter(v=>v.register_info.is_green),d=e.filter(v=>!v.register_info.is_green);return{agents:e,greenAgents:o,opponentAgents:d}}catch(t){return console.error("[stage-battle/+page.ts] Error loading agents:",t),{agents:[],greenAgents:[],opponentAgents:[]}}},ci=Object.freeze(Object.defineProperty({__proto__:null,load:_s},Symbol.toStringTag,{value:"Module"}));async function bs(n){try{const t=await fetch("/api/battles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!t.ok){const o=await t.json();throw new Error(o.detail||"Failed to create battle")}return await t.json()}catch(t){throw console.error("Failed to create battle:",t),t}}var ys=k('<span class="absolute right-2 flex size-3.5 items-center justify-center"><!></span> <!>',1);function Hr(n,t){q(t,!0);let e=m(t,"ref",15,null),o=nt(t,["$$slots","$$events","$$legacy","ref","class","value","label","children"]);var d=I(),v=b(d);{const a=(l,h)=>{let c=()=>h==null?void 0:h().selected,P=()=>h==null?void 0:h().highlighted;var w=ys(),T=b(w),y=E(T);{var H=f=>{Ro(f,{class:"size-4"})};K(y,f=>{c()&&f(H)})}B(T);var F=D(T,2);{var O=f=>{var C=I(),J=b(C);L(J,()=>t.children,()=>({selected:c(),highlighted:P()})),i(f,C)},S=f=>{var C=ft();xt(()=>dt(C,t.label||t.value)),i(f,C)};K(F,f=>{t.children?f(O):f(S,!1)})}i(l,w)};let u=N(()=>zt("data-[highlighted]:bg-accent data-[highlighted]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground outline-hidden *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2 relative flex w-full cursor-default select-none items-center gap-2 rounded-sm py-1.5 pl-2 pr-8 text-sm data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none [&_svg]:shrink-0",t.class));Bt(v,()=>is,(l,h)=>{h(l,Nt({get value(){return t.value},"data-slot":"select-item",get class(){return r(u)}},()=>o,{get ref(){return e()},set ref(c){e(c)},children:a,$$slots:{default:!0}}))})}i(n,d),G()}function ws(n,t){q(t,!0);/**
 * @license @lucide/svelte v0.515.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */let e=nt(t,["$$slots","$$events","$$legacy"]);const o=[["path",{d:"m18 15-6-6-6 6"}]];Co(n,Nt({name:"chevron-up"},()=>e,{get iconNode(){return o},children:(d,v)=>{var a=I(),u=b(a);L(u,()=>t.children??mt),i(d,a)},$$slots:{default:!0}})),G()}function Ss(n,t){q(t,!0);let e=m(t,"ref",15,null),o=nt(t,["$$slots","$$events","$$legacy","ref","class"]);var d=I(),v=b(d);{let a=N(()=>zt("flex cursor-default items-center justify-center py-1",t.class));Bt(v,()=>gs,(u,l)=>{l(u,Nt({"data-slot":"select-scroll-up-button",get class(){return r(a)}},()=>o,{get ref(){return e()},set ref(h){e(h)},children:(h,c)=>{ws(h,{class:"size-4"})},$$slots:{default:!0}}))})}i(n,d),G()}function xs(n,t){q(t,!0);let e=m(t,"ref",15,null),o=nt(t,["$$slots","$$events","$$legacy","ref","class"]);var d=I(),v=b(d);{let a=N(()=>zt("flex cursor-default items-center justify-center py-1",t.class));Bt(v,()=>hs,(u,l)=>{l(u,Nt({"data-slot":"select-scroll-down-button",get class(){return r(a)}},()=>o,{get ref(){return e()},set ref(h){e(h)},children:(h,c)=>{qr(h,{class:"size-4"})},$$slots:{default:!0}}))})}i(n,d),G()}var Ns=k("<!> <!> <!>",1);function Dr(n,t){q(t,!0);let e=m(t,"ref",15,null),o=m(t,"sideOffset",3,4),d=nt(t,["$$slots","$$events","$$legacy","ref","class","sideOffset","portalProps","children"]);var v=I(),a=b(v);Bt(a,()=>No,(u,l)=>{l(u,Nt(()=>t.portalProps,{children:(h,c)=>{var P=I(),w=b(P);{let T=N(()=>zt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 max-h-(--bits-select-content-available-height) origin-(--bits-select-content-transform-origin) relative z-50 min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border shadow-md data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t.class));Bt(w,()=>rs,(y,H)=>{H(y,Nt({get sideOffset(){return o()},"data-slot":"select-content",get class(){return r(T)}},()=>d,{get ref(){return e()},set ref(F){e(F)},children:(F,O)=>{var S=Ns(),f=b(S);Ss(f,{});var C=D(f,2);{let R=N(()=>zt("h-(--bits-select-anchor-height) min-w-(--bits-select-anchor-width) w-full scroll-my-1 p-1"));Bt(C,()=>as,(Y,z)=>{z(Y,{get class(){return r(R)},children:(ht,at)=>{var st=I(),Q=b(st);L(Q,()=>t.children??mt),i(ht,st)},$$slots:{default:!0}})})}var J=D(C,2);xs(J,{}),i(F,S)},$$slots:{default:!0}}))})}i(h,P)},$$slots:{default:!0}}))}),i(n,v),G()}var Cs=k("<!> <!>",1);function Br(n,t){q(t,!0);let e=m(t,"ref",15,null),o=m(t,"size",3,"default"),d=nt(t,["$$slots","$$events","$$legacy","ref","class","children","size"]);var v=I(),a=b(v);{let u=N(()=>zt("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 shadow-xs flex w-fit select-none items-center justify-between gap-2 whitespace-nowrap rounded-md border bg-transparent px-3 py-2 text-sm outline-none transition-[color,box-shadow] focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg:not([class*='size-'])]:size-4 [&_svg]:pointer-events-none [&_svg]:shrink-0",t.class));Bt(a,()=>ms,(l,h)=>{h(l,Nt({"data-slot":"select-trigger",get"data-size"(){return o()},get class(){return r(u)}},()=>d,{get ref(){return e()},set ref(c){e(c)},children:(c,P)=>{var w=Cs(),T=b(w);L(T,()=>t.children??mt);var y=D(T,2);qr(y,{class:"size-4 opacity-50"}),i(c,w)},$$slots:{default:!0}}))})}i(n,v),G()}const Er=fs;var Ps=k('<div class="flex items-center justify-center p-8"><div class="text-center"><p class="text-green-600 mb-4">Battle created successfully! Redirecting to battles page...</p></div></div>'),Ts=k('<div class="flex items-center justify-center p-8"><div class="text-center"><p class="text-destructive mb-4"> </p></div></div>'),As=k("<!> <!>",1),Is=k("<span> </span>"),Os=k("<!> <!>",1),ks=k('<div class="text-destructive text-sm"> </div>'),Hs=k('<div class="text-muted-foreground text-sm">Enter a valid JSON object for battle configuration</div>'),Ds=k('<form class="space-y-4"><div class="space-y-2"><!> <!></div>   <div class="space-y-2"><!> <textarea id="config_json" class="w-full px-3 py-2 border border-input rounded-md text-sm font-mono resize-vertical min-h-[80px]" rows="4"></textarea> <!></div> <div class="flex gap-2 pt-4"><!> <!></div></form>'),Bs=k("<!> <!>",1),Es=k("<!> <!>",1),Ms=k("<span> </span>"),Vs=k("<!> <!>",1),Rs=k('<div class="flex flex-col gap-2 p-3 border rounded-lg"><div class="font-medium"> <span class="text-xs text-muted-foreground"> </span> </div> <!></div>'),Fs=k('<div class="space-y-4"></div>'),Us=k('<div class="text-muted-foreground">Select a green agent to see required roles.</div>'),js=k("<!> <!>",1),Ks=k('<div class="container mx-auto p-6 max-w-6xl"><div class="text-center mb-8"><h1 class="text-4xl font-bold mb-6">Stage a Battle</h1> <p class="text-muted-foreground">Create a new battle between agents</p></div> <!> <!> <div class="grid gap-6 md:grid-cols-2"><!> <!></div> <details class="mt-8"><summary class="text-lg font-medium cursor-pointer">Debug: Form Data</summary> <div class="mt-4 p-4 bg-muted rounded-lg"><pre class="text-xs overflow-auto max-h-60"> </pre></div></details></div>');function gi(n,t){q(t,!1);const[e,o]=ho(),d=()=>uo(jo,"$loading",e),v=At();let a=m(t,"data",8),u=null;ro(async()=>{const{data:{session:_}}=await Fo.auth.getSession();if(!_){console.log("Stage battle page: No session found, redirecting to login"),Re("/login");return}u=Uo.subscribe(U=>{!U&&!d()&&(console.log("Stage battle page: User logged out, redirecting to login"),Re("/login"))})}),oo(()=>{u&&u()});let l=At({green_agent_id:"",config:{}}),h=At(""),c=At(""),P=At(!1),w=At(null),T=At(!1),y=At({}),H=At([]);function F(){if(g(c,""),!r(h).trim()){Ut(l,r(l).config={});return}try{const _=JSON.parse(r(h));typeof _=="object"&&_!==null&&!Array.isArray(_)?(Ut(l,r(l).config=_),g(l,{...r(l)})):g(c,"Config must be a valid JSON object")}catch{g(c,"Invalid JSON syntax")}}async function O(){try{g(P,!0),g(w,null),g(T,!1);const _=r(H).filter(V=>r(y)[V.name]).map(V=>({name:V.name,agent_id:r(y)[V.name]}));if(_.length!==r(H).filter(V=>V.required).length)throw new Error("Please assign an agent to every required role.");const U={green_agent_id:r(l).green_agent_id,opponents:_,config:r(l).config};console.log("[stage-battle/+page.svelte] Creating battle:",U);const M=await bs(U);console.log("[stage-battle/+page.svelte] Battle created successfully:",M),g(T,!0),setTimeout(()=>{Re(`/battles/${M.battle_id}`)},2e3)}catch(_){console.error("[stage-battle/+page.svelte] Error creating battle:",_),g(w,_ instanceof Error?_.message:"Failed to create battle")}finally{g(P,!1)}}Ve(()=>{},()=>{Ut(l,r(l).green_agent_id="")}),Ve(()=>(r(l),Zt(a()),r(H),r(y)),()=>{var _;if(r(l).green_agent_id){const U=a().greenAgents.find(M=>M.agent_id===r(l).green_agent_id);g(H,((_=U==null?void 0:U.register_info)==null?void 0:_.participant_requirements)||[]);for(const M of r(H))M.name in r(y)||Ut(y,r(y)[M.name]="");for(const M of Object.keys(r(y)))r(H).some(V=>V.name===M)||delete r(y)[M]}else g(H,[]),g(y,{})}),Ve(()=>r(l),()=>{Object.keys(r(l).config).length===0?g(h,""):g(h,JSON.stringify(r(l).config,null,2))}),Ve(()=>(r(l),r(y),r(H)),()=>{g(v,{green_agent_id:r(l).green_agent_id,config:r(l).config,roleAssignments:{...r(y)},opponents:r(H).filter(_=>r(y)[_.name]).map(_=>({name:_.name,agent_id:r(y)[_.name]}))})}),io(),eo();var S=Ks();no(_=>{ao.title="Stage Battle - AgentBeats"});var f=D(E(S),2);{var C=_=>{var U=Ps();i(_,U)};K(f,_=>{r(T)&&_(C)})}var J=D(f,2);{var R=_=>{var U=Ts(),M=E(U),V=E(M),ut=E(V,!0);B(V),B(M),B(U),xt(()=>dt(ut,r(w))),i(_,U)};K(J,_=>{r(w)&&_(R)})}var Y=D(J,2),z=E(Y);Sr(z,{children:(_,U)=>{var M=Bs(),V=b(M);xr(V,{children:(ct,ze)=>{var it=As(),gt=b(it);Nr(gt,{children:(pt,rt)=>{St();var X=ft("Battle Configuration");i(pt,X)},$$slots:{default:!0}});var Ht=D(gt,2);Pr(Ht,{children:(pt,rt)=>{St();var X=ft("Set up the battle parameters");i(pt,X)},$$slots:{default:!0}}),i(ct,it)},$$slots:{default:!0}});var ut=D(V,2);Cr(ut,{children:(ct,ze)=>{var it=Ds(),gt=E(it),Ht=E(gt);Ar(Ht,{for:"green_agent",children:(j,lt)=>{St();var W=ft("Green Agent (Battle Initiator)");i(j,W)},$$slots:{default:!0}});var pt=D(Ht,2);Er(pt,{type:"single",required:!0,get value(){return r(l).green_agent_id},set value(j){Ut(l,r(l).green_agent_id=j)},children:(j,lt)=>{var W=Os(),Je=b(W);Br(Je,{children:(Rt,We)=>{var _t=Is(),Yt=E(_t,!0);B(_t),xt(tt=>dt(Yt,tt),[()=>(r(l),Zt(a()),et(()=>{var tt;return r(l).green_agent_id?(tt=a().greenAgents.find(bt=>bt.agent_id===r(l).green_agent_id))==null?void 0:tt.register_info.name:"Select a green agent"}))]),i(Rt,_t)},$$slots:{default:!0}});var Me=D(Je,2);Dr(Me,{children:(Rt,We)=>{var _t=I(),Yt=b(_t);Fe(Yt,1,()=>(Zt(a()),et(()=>a().greenAgents)),tt=>tt.agent_id,(tt,bt)=>{Hr(tt,{get value(){return r(bt),et(()=>r(bt).agent_id)},children:(yt,wt)=>{St();var Qt=ft();xt(()=>dt(Qt,(r(bt),et(()=>r(bt).register_info.name)))),i(yt,Qt)},$$slots:{default:!0}})}),i(Rt,_t)},$$slots:{default:!0}}),i(j,W)},$$slots:{default:!0},$$legacy:!0}),B(gt);var rt=D(gt,2),X=E(rt);Ar(X,{for:"config_json",children:(j,lt)=>{St();var W=ft("Custom Configuration (JSON)");i(j,W)},$$slots:{default:!0}});var Tt=D(X,2);lo(Tt),co(Tt,"placeholder",et(()=>JSON.stringify({battle_config:"content",max_rounds:10,debug_mode:!0})));var Z=D(Tt,2);{var Wt=j=>{var lt=ks(),W=E(lt,!0);B(lt),xt(()=>dt(W,r(c))),i(j,lt)},qt=j=>{var lt=Hs();i(j,lt)};K(Z,j=>{r(c)?j(Wt):j(qt,!1)})}B(rt);var Gt=D(rt,2),Vt=E(Gt);Tr(Vt,{type:"submit",get disabled(){return r(P)},children:(j,lt)=>{St();var W=ft();xt(()=>dt(W,r(P)?"Creating...":"Create Battle")),i(j,W)},$$slots:{default:!0}});var Le=D(Vt,2);Tr(Le,{type:"button",variant:"outline",onclick:()=>Re("/battles"),children:(j,lt)=>{St();var W=ft("Cancel");i(j,W)},$$slots:{default:!0}}),B(Gt),B(it),Mr(Tt,()=>r(h),j=>g(h,j)),yr("blur",Tt,F),yr("submit",it,Ko(O)),i(ct,it)},$$slots:{default:!0}}),i(_,M)},$$slots:{default:!0}});var ht=D(z,2);Sr(ht,{children:(_,U)=>{var M=js(),V=b(M);xr(V,{children:(ct,ze)=>{var it=Es(),gt=b(it);Nr(gt,{children:(pt,rt)=>{St();var X=ft("Assign Agents to Roles");i(pt,X)},$$slots:{default:!0}});var Ht=D(gt,2);Pr(Ht,{children:(pt,rt)=>{St();var X=ft("Assign an agent to each required role for this battle");i(pt,X)},$$slots:{default:!0}}),i(ct,it)},$$slots:{default:!0}});var ut=D(V,2);Cr(ut,{class:"space-y-6",children:(ct,ze)=>{var it=I(),gt=b(it);{var Ht=rt=>{var X=Fs();Fe(X,5,()=>r(H),Tt=>Tt.name,(Tt,Z)=>{var Wt=Rs(),qt=E(Wt),Gt=E(qt),Vt=D(Gt),Le=E(Vt);B(Vt);var j=D(Vt);B(qt);var lt=D(qt,2);Er(lt,{type:"single",required:!0,get value(){return r(y)[r(Z).name]},set value(W){Ut(y,r(y)[r(Z).name]=W)},children:(W,Je)=>{var Me=Vs(),Rt=b(Me);Br(Rt,{children:(_t,Yt)=>{var tt=Ms(),bt=E(tt,!0);B(tt),xt(yt=>dt(bt,yt),[()=>(r(y),r(Z),Zt(a()),et(()=>{var yt;return r(y)[r(Z).name]?(yt=a().opponentAgents.find(wt=>wt.agent_id===r(y)[r(Z).name]))==null?void 0:yt.register_info.name:"Select agent"}))]),i(_t,tt)},$$slots:{default:!0}});var We=D(Rt,2);Dr(We,{children:(_t,Yt)=>{var tt=I(),bt=b(tt);Fe(bt,1,()=>(Zt(a()),et(()=>a().opponentAgents)),yt=>yt.agent_id,(yt,wt)=>{var Qt=I(),Xr=b(Qt);{var Zr=qe=>{Hr(qe,{get value(){return r(wt),et(()=>r(wt).agent_id)},children:(Ge,mr)=>{St();var _r=ft();xt(()=>dt(_r,(r(wt),et(()=>r(wt).register_info.name)))),i(Ge,_r)},$$slots:{default:!0}})};K(Xr,qe=>{r(y),r(Z),r(wt),et(()=>!Object.entries(r(y)).some(([Ge,mr])=>Ge!==r(Z).name&&mr===r(wt).agent_id)||r(y)[r(Z).name]===r(wt).agent_id)&&qe(Zr)})}i(yt,Qt)}),i(_t,tt)},$$slots:{default:!0}}),i(W,Me)},$$slots:{default:!0},$$legacy:!0}),B(Wt),xt(()=>{dt(Gt,`${r(Z),et(()=>r(Z).name)??""} `),dt(Le,`(${r(Z),et(()=>r(Z).role)??""})`),dt(j,` ${r(Z),et(()=>r(Z).required?"*":"")??""}`)}),i(Tt,Wt)}),B(X),i(rt,X)},pt=rt=>{var X=Us();i(rt,X)};K(gt,rt=>{r(H),et(()=>r(H).length>0)?rt(Ht):rt(pt,!1)})}i(ct,it)},$$slots:{default:!0}}),i(_,M)},$$slots:{default:!0}}),B(Y);var at=D(Y,2),st=D(E(at),2),Q=E(st),$=E(Q,!0);B(Q),B(st),B(at),B(S),xt(_=>dt($,_),[()=>(r(v),et(()=>JSON.stringify(r(v),null,2)))]),i(n,S),G(),o()}export{gi as component,ci as universal};

<script lang="ts" module>import { CSS, isKeyboardEvent, styleObjectToString } from "@dnd-kit-svelte/utilities";
import { getRelativeTransformOrigin } from "../../../../utilities/index.js";
const baseStyles = {
  position: "fixed",
  touchAction: "none"
};
function defaultTransition(activatorEvent) {
  const isKeyboardActivator = isKeyboardEvent(activatorEvent);
  return isKeyboardActivator ? "transform 250ms ease" : void 0;
}
</script>

<script lang="ts">let {
  as,
  activatorEvent,
  adjustScale,
  children,
  className,
  rect,
  style,
  transform,
  transition = defaultTransition,
  handleExit,
  ref = $bindable(),
  onStylesUpdated
} = $props();
let scaleAdjustedTransform = $derived(
  adjustScale ? transform : {
    ...transform,
    scaleX: 1,
    scaleY: 1
  }
);
let styles = $derived.by(() => {
  if (!rect) {
    return {};
  }
  return {
    ...baseStyles,
    width: rect.width,
    height: rect.height,
    top: rect.top,
    left: rect.left,
    transform: CSS.Transform.toString(scaleAdjustedTransform),
    transformOrigin: adjustScale && activatorEvent ? getRelativeTransformOrigin(activatorEvent, rect) : void 0,
    transition: typeof transition === "function" ? transition(activatorEvent) : transition,
    ...style
  };
});
const stylesString = $derived(styleObjectToString(styles));
$effect(() => {
  onStylesUpdated(stylesString);
});
</script>

{#if rect}
	<svelte:element this={as} bind:this={ref} class={className} style={stylesString} use:handleExit>
		{@render children?.()}
	</svelte:element>
{/if}
